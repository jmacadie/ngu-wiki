<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NGU Alliance Guides</title>
  <style>
    body { font-family: Arial, sans-serif; line-height: 1.6; max-width: 800px; margin: 2em auto; padding: 1em; background: #f8f8f8; color: #333; }
    h1, h2, h3 { color: #2a2a2a; }
    ul { margin-left: 1.5em; }
    a { color: #0066cc; text-decoration: none; }
    a.missing { color: #a6a2a1; }
    a.current { color: #9896fa; }
    nav { background-color: #333; padding: 1em; text-align: center; margin-bottom: 2em; }
    nav a { color: white; margin: 0 1em; font-weight: bold; }
    nav a:hover { text-decoration: underline; }
    header { text-align: center; font-size: 2em; margin-bottom: 1em; font-weight: bold; color: #444; }
    .grid-container { display: flex; flex-direction: column; gap: 0.75em; margin-top: 2em; }
    .grid-row { display: flex; flex-wrap: nowrap; min-height: 25px; }
    .grid-cell { flex: 1 1 25%; padding: 0.25em 0.5em; box-sizing: border-box; min-width: 100px; }
    .grid-cell.wide { flex: 1 1 75%; }
    .grid-cell input[type="number"] { width: 100%; padding: 0.25em; box-sizing: border-box; }
    .output { font-weight: bold; }
    .output-info { font-style: italic; }
  </style>
</head>
<body>
  <header>NGU Alliance</header>
  <nav>
    <a href="/">Home</a>
    <a href="/events">Events</a>
    <a href="/" class="missing">Buildings</a>
    <a href="/troops">Troops</a>
    <a href="javascript:void(0)" class="current">Healing</a>
  </nav>

  <h1>Healing Troops</h1>

  <p>In the infirmary, you don't need to heal all troops at once. Adjust down the sliders and you will heal fewer troops.</p>
  <p>Why do that? Well, once a heal is underway you can request help from allies to speed that healing session.</p>
  <p>By batching up heal sessions into groups that can be fully helped by allies, you can instantly heal <em>any</em> amount of troops.</p>
  <br />
  <p>Go to your Embassy and click on <strong>Details</strong> and look for <strong>Ally Assists</strong> and <strong>Ally Help Time</strong>. This is how much help you can get for each request.</p>
  <p>The black numbers are your base levels and the green numbers are additions from research. You need to add the two together.</p>

  <div class="grid-container">
    <div class="grid-row">
      <div class="grid-cell"></div>
      <div class="grid-cell">Base stats</div>
      <div class="grid-cell">Research stats</div>
      <div class="grid-cell">Total</div>
    </div>
    <div class="grid-row">
      <div class="grid-cell">Ally Assists</div>
      <div class="grid-cell"><input type="number" id="baseAssists" value="0"></div>
      <div class="grid-cell"><input type="number" id="researchAssists" value="0"></div>
      <div class="grid-cell output" id="totalAssists">0</div>
    </div>
    <div class="grid-row">
      <div class="grid-cell">Ally Help Time (s)</div>
      <div class="grid-cell"><input type="number" id="baseHelpTime" value="0"></div>
      <div class="grid-cell"><input type="number" id="researchHelpTime" value="0"></div>
      <div class="grid-cell output" id="totalHelpTime">0s</div>
    </div>
    <div class="grid-row">
      <div class="grid-cell">Allies online</div>
      <div class="grid-cell"><input type="number" id="alliesOnline" value="0"></div>
      <div class="grid-cell"></div>
      <div class="grid-cell"></div>
    </div>
	<div class="grid-row"></div>
    <div class="grid-row">
      <div class="grid-cell">Max help:</div>
      <div class="grid-cell wide output-info" id="maxHelp">0s</div>
    </div>
    <div class="grid-row">
      <div class="grid-cell">Immediate help:</div>
      <div class="grid-cell wide output" id="immediateHelp">0s</div>
    </div>
  </div>

  <script>
    const inputIds = [
      'baseAssists', 'researchAssists',
      'baseHelpTime', 'researchHelpTime',
      'alliesOnline'
    ];

    const STORAGE_KEY = 'ngu_healing_inputs';

    function saveInputsToLocalStorage() {
      const data = {};
      for (const id of inputIds) {
        const value = document.getElementById(id).value;
        data[id] = value;
      }
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function loadInputsFromLocalStorage() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          const data = JSON.parse(saved);
          for (const id of inputIds) {
            if (id in data) {
              document.getElementById(id).value = data[id];
            }
          }
        } catch (e) {
          console.warn('Failed to parse saved inputs:', e);
        }
      }
    }

    function toHMS(seconds) {
      const h = Math.floor(seconds / 3600);
      const m = Math.floor((seconds % 3600) / 60);
      const s = seconds % 60;
      if (h === 0 && m === 0) return `${s}s`;
      if (h === 0 && s === 0) return `${m}m`;
      if (m === 0 && s === 0) return `${h}h`;
      if (h === 0) return `${m}m ${s}s`;
      if (m === 0) return `${h}h ${s}s`;
      if (s === 0) return `${h}h ${m}m`;
      return `${h}h ${m}m ${s}s`;
    }

    function updateCalculations() {
      const baseAssists = parseInt(document.getElementById('baseAssists').value) || 0;
      const researchAssists = parseInt(document.getElementById('researchAssists').value) || 0;
      const baseHelpTime = parseInt(document.getElementById('baseHelpTime').value) || 0;
      const researchHelpTime = parseInt(document.getElementById('researchHelpTime').value) || 0;
      const alliesOnline = parseInt(document.getElementById('alliesOnline').value) || 0;

      const totalAssists = baseAssists + researchAssists;
      const totalHelpTime = baseHelpTime + researchHelpTime;
      const maxHelp = totalAssists * totalHelpTime;
      const immediateHelp = Math.min(totalAssists, alliesOnline) * totalHelpTime;

      document.getElementById('totalAssists').textContent = totalAssists;
      document.getElementById('totalHelpTime').textContent = toHMS(totalHelpTime);
      document.getElementById('maxHelp').textContent = toHMS(maxHelp);
      document.getElementById('immediateHelp').textContent = toHMS(immediateHelp);

      saveInputsToLocalStorage();
    }

    // Set up listeners
    inputIds.forEach(id => {
      document.getElementById(id).addEventListener('input', updateCalculations);
    });

    // Load on page start and run once
    loadInputsFromLocalStorage();
    updateCalculations();
</script>

</body>
</html>
